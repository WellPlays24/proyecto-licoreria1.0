<!-- ============================================
     NAVBAR DINÁMICO SEGÚN AUTENTICACIÓN Y ROL
     ============================================ -->

<mat-toolbar color="primary" class="navbar">
  <div class="navbar-container">
    <!-- Logo -->
    <a routerLink="/" class="logo">
      <mat-icon>liquor</mat-icon>
      <span>Licorería</span>
    </a>

    <!-- Spacer -->
    <span class="spacer"></span>

    <!-- ============================================
         MENÚ PARA USUARIOS NO AUTENTICADOS
         ============================================ -->
    <div class="nav-links" *ngIf="!isAuthenticated">
      <button mat-button routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <mat-icon>home</mat-icon>
        Inicio
      </button>
      <button mat-button routerLink="/nosotros" routerLinkActive="active">
        <mat-icon>info</mat-icon>
        Nosotros
      </button>
      <button mat-raised-button color="accent" routerLink="/login">
        <mat-icon>login</mat-icon>
        Iniciar Sesión
      </button>
      <button mat-button routerLink="/register">
        Registrarse
      </button>
    </div>

    <!-- ============================================
         MENÚ PARA CLIENTES AUTENTICADOS
         ============================================ -->
    <div class="nav-links" *ngIf="isAuthenticated && isClient">
      <button mat-button routerLink="/" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
        <mat-icon>home</mat-icon>
        Inicio
      </button>
      <button mat-button routerLink="/products" routerLinkActive="active">
        <mat-icon>shopping_bag</mat-icon>
        Productos
      </button>
      <button mat-button routerLink="/cart" routerLinkActive="active">
        <mat-icon [matBadge]="(cartCount$ | async) || 0" matBadgeColor="warn" [matBadgeHidden]="(cartCount$ | async) === 0">
          shopping_cart
        </mat-icon>
        Carrito
      </button>
      <button mat-button routerLink="/orders" routerLinkActive="active">
        <mat-icon>receipt_long</mat-icon>
        Mis Pedidos
      </button>
      <button mat-button routerLink="/invoices" routerLinkActive="active">
        <mat-icon>description</mat-icon>
        Facturas
      </button>
      
      <!-- Menú del usuario -->
      <button mat-icon-button [matMenuTriggerFor]="userMenu">
        <mat-icon>account_circle</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <div class="user-info" mat-menu-item disabled>
          <strong>{{ (currentUser$ | async)?.name }}</strong>
        </div>
        <mat-divider></mat-divider>
        <button mat-menu-item routerLink="/profile">
          <mat-icon>person</mat-icon>
          Mi Perfil
        </button>
        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          Cerrar Sesión
        </button>
      </mat-menu>
    </div>

    <!-- ============================================
         MENÚ PARA ADMINISTRADORES
         ============================================ -->
    <div class="nav-links" *ngIf="isAuthenticated && isAdmin">
      <button mat-button routerLink="/admin/dashboard" routerLinkActive="active">
        <mat-icon>dashboard</mat-icon>
        Dashboard
      </button>
      <button mat-button routerLink="/admin/categories" routerLinkActive="active">
        <mat-icon>category</mat-icon>
        Categorías
      </button>
      <button mat-button routerLink="/admin/products" routerLinkActive="active">
        <mat-icon>inventory</mat-icon>
        Productos
      </button>
      <button mat-button routerLink="/admin/orders" routerLinkActive="active">
        <mat-icon>shopping_basket</mat-icon>
        Pedidos
      </button>
      <button mat-button routerLink="/admin/invoices" routerLinkActive="active">
        <mat-icon>receipt</mat-icon>
        Facturas
      </button>
      
      <!-- Menú del admin -->
      <button mat-icon-button [matMenuTriggerFor]="adminMenu">
        <mat-icon>admin_panel_settings</mat-icon>
      </button>
      <mat-menu #adminMenu="matMenu">
        <div class="user-info" mat-menu-item disabled>
          <strong>{{ (currentUser$ | async)?.name }}</strong>
          <span class="admin-badge">Admin</span>
        </div>
        <mat-divider></mat-divider>
        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          Cerrar Sesión
        </button>
      </mat-menu>
    </div>
  </div>
</mat-toolbar>